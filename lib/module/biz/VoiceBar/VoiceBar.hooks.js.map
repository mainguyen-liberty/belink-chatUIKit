{"version":3,"names":["React","AudioEncoderAndroidType","AudioSourceAndroidType","AVEncoderAudioQualityIOSType","AVEncodingOption","AVModeIOSOption","useChatContext","Services","getFileExtension","LocalPath","uuid","useVoiceBar","props","onClickedRecordButton","onClickedClearButton","onClickedSendButton","onFailed","onState","propsOnState","state","setState","useState","voiceFilePathRef","useRef","voiceFileNameRef","voiceDurationRef","isPlayingRef","recordTimeoutRef","im","contentTimerRef","playRipple","setPlayRipple","AudioOptionRef","AudioEncoderAndroid","AAC","AudioSourceAndroid","MIC","AVModeIOS","measurement","AVEncoderAudioQualityKeyIOS","high","AVNumberOfChannelsKeyIOS","AVFormatIDKeyIOS","aac","currentTime","setCurrentTime","onContentTimeChanged","useCallback","v","s","startRecord","voiceFilePath","_contentTimerRef$curr","_contentTimerRef$curr2","_contentTimerRef$curr3","_contentTimerRef$curr4","current","setTimeout","stopRecord","reset","call","start","ms","startRecordAudio","url","audio","onPosition","pos","console","log","Math","floor","error","_contentTimerRef$curr5","_contentTimerRef$curr6","warn","reason","stop","onFinished","_ref","result","path","then","catch","_contentTimerRef$curr7","_contentTimerRef$curr8","_contentTimerRef$curr9","_contentTimerRef$curr10","clearTimeout","undefined","conv","getCurrentConversation","stopRecordAudio","localPath","sendVoice","dcs","getFileDir","convId","extension","saveFromLocal","targetPath","replay","_contentTimerRef$curr11","_contentTimerRef$curr12","_contentTimerRef$curr13","_contentTimerRef$curr14","playAudio","playVoice","onPlay","_ref2","currentPosition","duration","_contentTimerRef$curr15","_contentTimerRef$curr16","_contentTimerRef$curr17","_contentTimerRef$curr18","_onClickedRecordButton","_onClickedClearButton","_contentTimerRef$curr19","_contentTimerRef$curr20","stopAudio","_onClickedSendButton","displayName","type","useEffect"],"sourceRoot":"../../../../src","sources":["biz/VoiceBar/VoiceBar.hooks.tsx"],"mappings":"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"}