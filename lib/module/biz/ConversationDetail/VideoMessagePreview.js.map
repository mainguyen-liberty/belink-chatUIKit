{"version":3,"names":["React","Platform","Pressable","StyleSheet","useWindowDimensions","View","ChatDownloadStatus","ChatMessageType","useSafeAreaInsets","Video","useChatContext","ErrorCode","UIKitError","useColors","Services","usePaletteContext","Icon","Image","LoadingIcon","getFileDirectory","getFileExtension","LocalPath","uuid","useImageSize","getImageSizeFromUrl","VideoMessagePreview","props","containerStyle","onBack","url","size","videoRef","onVideoError","onClickedVideo","onEnd","pause","thumbnailUrl","showLoading","useVideoMessagePreview","top","colors","getColor","bg","light","neutral","dark","fg","icon","createElement","style","flexGrow","backgroundColor","justifyContent","alignItems","onPress","ref","source","uri","paused","onError","resizeMode","position","absoluteFill","height","width","left","name","tintColor","msgId","propsMsgId","im","useRef","setUrl","useState","setSize","winWidth","winHeight","setShowLoading","setThumbnailUrl","undefined","setPause","getImageSize","genThumb","useCallback","videoPath","onFinished","isExisted","dcs","isExistedFile","ms","getVideoThumbnail","then","tmpFilePath","length","dir","extension","localPath","saveFromLocal","targetPath","catch","setThumbSize","showImage","_ref","isOk","showThumb","thumbnailLocalPath","thumbIsExisted","onGetMessage","getMessage","messageId","result","body","type","VIDEO","code","chat_uikit","desc","thumbnailRemotePath","messageManager","downloadAttachment","playVideo","error","console","log","OS","_videoRef$current","_videoRef$current2","current","seek","v","presentFullscreenPlayer","_videoRef$current3","_videoRef$current4","onGenerateThumbnail","msg","thumbLocalPath","thumbnailStatus","SUCCESS","updateMessage","message","onResult","useEffect","listener","onMessageAttachmentChanged","fileStatus","FAILED","addListener","removeListener"],"sourceRoot":"../../../../src","sources":["biz/ConversationDetail/VideoMessagePreview.tsx"],"mappings":"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"}